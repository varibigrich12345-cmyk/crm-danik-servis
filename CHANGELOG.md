# История изменений

## [0.3.0] - 2026-01-29

### Добавлено
- Система запросов на делегирование и корректировку заявок
- Хук useRequests с функциями: useRequests, usePendingRequestsCount, useClaimRequests, useCreateRequest, useResolveRequest
- Панель запросов для админа в Header (колокольчик с бейджем)
- Кнопки "Запросить делегирование" и "Запросить корректировку" в форме заявки
- Статусы запросов (ожидает, одобрено, отклонено) с бейджами
- SQL миграция для таблицы requests

### Ограничения доступа
- Кнопки экспорта CSV видны только админу
- Мастер видит ВСЕ заявки, но редактирует только свои
- Чужие заявки открываются в режиме просмотра с возможностью запросить делегирование
- Выполненные заявки заблокированы, но можно запросить корректировку
- При одобрении корректировки заявка временно разблокируется (allow_edit)

### Типы
- Добавлен интерфейс Request
- Добавлен тип RequestType ('delegation' | 'correction')
- Добавлено поле allow_edit в Claim

## [0.2.1] - 2026-01-29

### Добавлено
- Валидация незнакомых запчастей при сохранении заявки
- Диалог выбора существующей запчасти или добавления новой в справочник
- Поиск похожих запчастей по частям слова

### Улучшено
- Автокомплит запчастей разделён на "Точные совпадения" и "Похожие записи"
- Исправлены все TypeScript ошибки для успешной сборки (npm run build)

### Сервер
- Исправлен nginx конфиг для правильных MIME types (JS, CSS)
- Добавлен favicon.ico
- Включено gzip сжатие и HTTP/2
- Настроено кеширование статики (1 год)

## [0.2.0] - 2026-01-29

### Добавлено
- Страница справочника клиентов (/clients) с CRUD операциями
- CSV экспорт списка заявок (кнопка "Экспорт" на странице заявок)
- CSV экспорт одной заявки с работами и запчастями для 1С (кнопка в каждой строке)
- Справочник запчастей part_dictionary (413 позиций)
- Автоскачивание PDF при отправке в WhatsApp/Telegram с подсказкой

### Улучшено
- Отправка в мессенджеры теперь сначала скачивает PDF
- Добавлена колонка скачивания CSV в таблице заявок

### База данных
- Заполнена таблица part_dictionary (фильтры, масла, тормоза, подвеска, рулевое, двигатель, трансмиссия, электрика, кузов, охлаждение, выхлоп, расходники)

## [0.1.0] - 2026-01-27

### Добавлено
- Базовая авторизация через Supabase
- Страница заявок
- Форма создания заявки
- Подключение к Supabase

### Исправлено
- RLS политики для profiles
- Редирект после входа
- Загрузка профиля (.maybeSingle)

### Известные проблемы
- Ошибка "Не удалось определить пользователя" при создании заявки

